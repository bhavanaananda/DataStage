<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html>

<head>
    <title>ADMIRAL: Data Submission</title>

    <!-- TODO: move to separate CSS file -->
    <style>
    td {
        background-color: #FFE;
    }
    </style>
 

    <link rel="stylesheet" href="./../css/SubmitDataset.css" type="text/css" />   
    
    <!-- Import jQuery framework -->
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4/jquery.min.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/jquery-ui.min.js"></script>
    <script type="text/javascript" src="../../jQuery/js/jquery-1.4.2.js"></script> 

    <!-- Import jQuery additional libraries -->
    <script type="text/javascript" src="../../jQuery/jquery.json-2.2.js"></script> 
 
    <!-- Import MochiKit modules: require MochiKit library functions to be fully qualified -->
    <script type="text/javascript">MochiKit = {__export__: false};</script>
    <script type="text/javascript" src="../../MochiKit/Base.js"></script>
    <script type="text/javascript" src="../../MochiKit/Iter.js"></script>

    <script type="text/javascript" src="../../MochiKit/Logging.js"></script>

    <!-- Import Admiral functions -->
    <script type="text/javascript" src="../../Admiral/admiral-base.js"></script>
    <script type="text/javascript" src="../../Admiral/Error.js"></script>
    <script type="text/javascript" src="../../Admiral/AsyncComputation.js"></script>
    <script type="text/javascript" src="./../js/DisplayDirectories.js"></script>
    <script type="text/javascript" src="./../js/GetMetadata.js"></script>
    <script type="text/javascript" src="../../SelectDataset/ListDatasets.js"></script>
    <script type="text/javascript" src="../../SelectDataset/GetDatasets.js"></script>
    <script>
    // Use jQuery via jQuery(...)
    jQuery.noConflict();
    </script>

    <!-- Execute the desired dataset listing logic -->
    <script>
            jQuery(document).ready( function ()
            {                         
                var m = new admiral.AsyncComputation();
                m.eval(function(value,callback)
                {
                       admiral.displayDirectories(callback);           
                });
                m.eval(function(value,callback)
                {                    
                    // Populate directory listing box with results received
                    jQuery("#dirlist").empty();
                    for (i=0; i<value.length; i++)
                    {  
                       newjelem='<span class="dirlistitem">'+value[i]+'</span>';
                       jQuery("#dirlist").append(newjelem);
                    }
                callback(val);
                });    
                m.eval(function(value, callback)
                {
                    // Set click handlers on directory items
                    jQuery("#dirlist > .dirlistitem").click( function()
                    {   
                        var n = new admiral.AsyncComputation();
                        
                        n.eval(function(valu,callback)
                        { 
                          directorySelected = jQuery(this).text();
                          jQuery("#datDir").val(directorySelected);
                          callback(directorySelected);
                        });
                        
                        n.eval(function(valu,callback)
                        {
                           admiral.getMetadata(valu,callback); 
                        });
                        
                        // Populate the other fields with the value received
                         n.eval(function(valu,callback)
                        {
                           
                        });
                        n.exec(null,admiral.noop);
                        
                    });
                });                    
                
                m.exec(null,admiral.noop);
            });                    
     </script>
</head> 

<body>
   <h1>Submit Datasets</h1>
   <form name="frm1" action="../../SubmitDatasetHandler/cgi-bin/SubmitDatasetHandler.py" method="post">
   <div class="box outer">
        <div class="box">
            <span class="label">Dataset Dir :</span>
            <span class="labelvalue">
                <input name="datDir" id="datDir" type="text" value="" size="50" />
            </span>
            <span class="labelvalue withpadding">
               <span id="dirlist" class="scrollbox">
                   <span class="dirlistitem">directoryname</span>
               </span>
            </span> 
        </div>
        <div class="box">
           <span class="label">Dataset Id :</span>
           <span class="labelvalue"><input name="datId" id="datId" type="text"/></span>
        </div>
        <div class="box">
           <span class="label">Title :</span>
           <span class="labelvalue"><input name="title" id="title" type="text"/></span>
        </div>
        <div class="box">
           <span class="label">Description :</span>
           <span class="labelvalue">
                <textarea rows="4"  cols="50"></textarea>
           </span>
        </div>
        <div class="box">
            <span class="label">User :</span>
            <span class="labelvalue">
                <input name="user" id="user" type="text"/>
            </span>
        </div>
        <div class="box">
            <span class="label">Password :</span>
            <span class="labelvalue">
                <input name="pass" id="pass" type="password"/>
            </span>
        </div>
        <div class="box">
            <span class="labelvalue">
                <input name="submit" id="submit" type="submit" value="Submit"/>
                <button  name="cancel" id="cancel" type="button"> Cancel </button>
                <!-- 
                onClick="navigateto('http://localhost/bhavana/google-admiral-jiscmrd/spike/applications/Admiral/ViewOrSubmitDatasets/index.html')
                -->
           </span>
        </div>
   </div>
</form>  
</body>

</html>

