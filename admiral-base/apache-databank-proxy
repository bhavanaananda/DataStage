# /etc/apache2/conf.d/databank-proxy.conf
#
# NOTE: 
# this file is copied by firstboot.sh and regenerated by createapacheuserconfig.sh
#
# Reverse-proxy paths /silos and /%{DATABANKSILO} to the designated
# Databank server running in Library Services
#
# See: http://httpd.apache.org/docs/2.0/mod/mod_proxy.html
#
# See also: http://httpd.apache.org/docs/2.0/vhosts/name-based.html
#
# Spurious warnings may be generated: see https://issues.apache.org/bugzilla/show_bug.cgi?id=44350
#

# See: 000-default.host

ProxyRequests Off
SSLProxyEngine on

<Proxy *>
  Order deny,allow
  Allow from all 
</Proxy>

ProxyPass        /silos https://%{DATABANKHOST}/silos
ProxyPassReverse /silos https://%{DATABANKHOST}/silos
ProxyPass        /silos/ https://%{DATABANKHOST}/silos/
ProxyPassReverse /silos/ https://%{DATABANKHOST}/silos/

ProxyPass        /static https://%{DATABANKHOST}/static
ProxyPassReverse /static https://%{DATABANKHOST}/static
ProxyPass        /static/ https://%{DATABANKHOST}/static/
ProxyPassReverse /static/ https://%{DATABANKHOST}/static/

ProxyPass        /admin http://%{HOSTFULLNAME}:8080/admin
ProxyPassReverse /admin http://%{HOSTFULLNAME}:8080/admin
ProxyPass        /admin/ http://%{HOSTFULLNAME}:8080/admin/
ProxyPassReverse /admin/ http://%{HOSTFULLNAME}:8080/admin/

ProxyPass        /users http://%{HOSTFULLNAME}:8080/users
ProxyPassReverse /users http://%{HOSTFULLNAME}:8080/users
ProxyPass        /users/ http://%{HOSTFULLNAME}:8080/users/
ProxyPassReverse /users/ http://%{HOSTFULLNAME}:8080/users/

ProxyPass        /user http://%{HOSTFULLNAME}:8080/user
ProxyPassReverse /user http://%{HOSTFULLNAME}:8080/user
ProxyPass        /user/ http://%{HOSTFULLNAME}:8080/user/
ProxyPassReverse /user/ http://%{HOSTFULLNAME}:8080/user/

ProxyPass        /error http://%{HOSTFULLNAME}:8080/error
ProxyPassReverse /error http://%{HOSTFULLNAME}:8080/error
ProxyPass        /error/ http://%{HOSTFULLNAME}:8080/error/
ProxyPassReverse /error/ http://%{HOSTFULLNAME}:8080/error/

ProxyPass        /databanksilo https://%{DATABANKHOST}/%{DATABANKSILO}
ProxyPassReverse /databanksilo https://%{DATABANKHOST}/%{DATABANKSILO}
ProxyPass        /databanksilo/ https://%{DATABANKHOST}/%{DATABANKSILO}/
ProxyPassReverse /databanksilo/ https://%{DATABANKHOST}/%{DATABANKSILO}/

ProxyPass        /%{DATABANKSILO} https://%{DATABANKHOST}/%{DATABANKSILO}
ProxyPassReverse /%{DATABANKSILO} https://%{DATABANKHOST}/%{DATABANKSILO}
ProxyPass        /%{DATABANKSILO}/ https://%{DATABANKHOST}/%{DATABANKSILO}/
ProxyPassReverse /%{DATABANKSILO}/ https://%{DATABANKHOST}/%{DATABANKSILO}/

#ProxyPreserveHost On
